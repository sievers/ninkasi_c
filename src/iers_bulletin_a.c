
#include <assert.h>
#include <math.h>

#include "iers_bulletin_a.h"

typedef struct { float x; float y; float dut1; } xyz;

struct season_info {
    int mjd_min, mjd_max;
    xyz *iers_bulletin_a_table;
};


static const xyz s1[] = {
  {.197846f, .261896f, -.1656442f}, // 54344
  {.196690f, .259844f, -.1664020f}, // 54345
  {.195332f, .257834f, -.1668913f}, // 54346
  {.194017f, .255871f, -.1671245f}, // 54347
  {.192566f, .253884f, -.1671878f}, // 54348
  {.190582f, .251822f, -.1672302f}, // 54349
  {.188552f, .249788f, -.1673569f}, // 54350
  {.186850f, .247717f, -.1676501f}, // 54351
  {.185549f, .246031f, -.1681548f}, // 54352
  {.184318f, .244405f, -.1688723f}, // 54353
  {.182768f, .242604f, -.1697019f}, // 54354
  {.181114f, .240563f, -.1705973f}, // 54355
  {.179227f, .238421f, -.1715590f}, // 54356
  {.177308f, .236307f, -.1724556f}, // 54357
  {.175077f, .234251f, -.1732340f}, // 54358
  {.172349f, .232232f, -.1738688f}, // 54359
  {.169627f, .230326f, -.1743528f}, // 54360
  {.167222f, .228494f, -.1747153f}, // 54361
  {.165159f, .226675f, -.1749653f}, // 54362
  {.163088f, .224793f, -.1751827f}, // 54363
  {.160462f, .223015f, -.1754827f}, // 54364
  {.157620f, .221118f, -.1759385f}, // 54365
  {.154711f, .219589f, -.1766034f}, // 54366
  {.151735f, .217998f, -.1775500f}, // 54367
  {.149034f, .216380f, -.1787957f}, // 54368
  {.146531f, .214823f, -.1803971f}, // 54369
  {.144031f, .213052f, -.1821224f}, // 54370
  {.141497f, .211101f, -.1837554f}, // 54371
  {.138683f, .209497f, -.1851753f}, // 54372
  {.136108f, .207821f, -.1863046f}, // 54373
  {.133566f, .206447f, -.1871348f}, // 54374
  {.130586f, .205313f, -.1877198f}, // 54375
  {.127516f, .204009f, -.1882266f}, // 54376
  {.124523f, .202867f, -.1887602f}, // 54377
  {.121546f, .201685f, -.1893749f}, // 54378
  {.118595f, .200523f, -.1900910f}, // 54379
  {.115681f, .199345f, -.1909531f}, // 54380
  {.112797f, .198279f, -.1919368f}, // 54381
  {.109778f, .197525f, -.1929827f}, // 54382
  {.106615f, .196831f, -.1940630f}, // 54383
  {.103296f, .195956f, -.1951621f}, // 54384
  {.100232f, .195044f, -.1961659f}, // 54385
  {.097521f, .194272f, -.1970283f}, // 54386
  {.094852f, .193584f, -.1977069f}, // 54387
  {.092006f, .192992f, -.1982271f}, // 54388
  {.088927f, .192567f, -.1986529f}, // 54389
  {.085841f, .192103f, -.1990366f}, // 54390
  {.082942f, .191867f, -.1994848f}, // 54391
  {.079904f, .191405f, -.2000408f}, // 54392
  {.076608f, .191030f, -.2007568f}, // 54393
  {.073424f, .190526f, -.2016848f}, // 54394
  {.070750f, .190159f, -.2028326f}, // 54395
  {.068560f, .190154f, -.2042226f}, // 54396
  {.066393f, .190392f, -.2058425f}, // 54397
  {.064116f, .190404f, -.2075348f}, // 54398
  {.061512f, .190078f, -.2090663f}, // 54399
  {.058856f, .190160f, -.2102561f}, // 54400
  {.056182f, .190273f, -.2110852f}, // 54401
  {.053428f, .190423f, -.2116676f}, // 54402
  {.050650f, .190668f, -.2121596f}, // 54403
  {.047663f, .190909f, -.2126471f}, // 54404
  {.044814f, .191049f, -.2132040f}, // 54405
  {.042285f, .191108f, -.2138903f}, // 54406
  {.040288f, .191493f, -.2147402f}, // 54407
  {.038221f, .192127f, -.2157262f}, // 54408
  {.035920f, .192552f, -.2167481f}, // 54409
  {.034039f, .192813f, -.2177933f}, // 54410
  {.032254f, .193090f, -.2188466f}, // 54411
  {.030184f, .193263f, -.2199019f}, // 54412
  {.027867f, .193383f, -.2208456f}, // 54413
  {.025274f, .193441f, -.2216030f}, // 54414
  {.022748f, .193570f, -.2221761f}, // 54415
  {.019964f, .194153f, -.2225899f}, // 54416
  {.016908f, .194712f, -.2229131f}, // 54417
  {.014037f, .194955f, -.2232638f}, // 54418
  {.011073f, .195484f, -.2237320f}, // 54419
  {.007872f, .196064f, -.2244439f}, // 54420
  {.004561f, .196430f, -.2254330f}, // 54421
  {.001372f, .197029f, -.2267030f}, // 54422
  {-.001555f, .198124f, -.2282814f}, // 54423
  {-.004213f, .199402f, -.2301190f}, // 54424
  {-.006928f, .200802f, -.2320994f}, // 54425
  {-.009466f, .202306f, -.2340995f}, // 54426
  {-.011938f, .203726f, -.2359422f}, // 54427
  {-.014899f, .204513f, -.2375090f}, // 54428
  {-.018139f, .204854f, -.2387677f}, // 54429
  {-.020843f, .205170f, -.2397811f}, // 54430
  {-.023072f, .205894f, -.2406888f}, // 54431
  {-.025300f, .206944f, -.2416482f}, // 54432
  {-.027277f, .208180f, -.2427560f}, // 54433
  {-.028727f, .209445f, -.2440641f}, // 54434
  {-.029633f, .211083f, -.2455588f}, // 54435
  {-.030691f, .212637f, -.2471393f}, // 54436
  {-.032054f, .214201f, -.2487433f}, // 54437
  {-.034042f, .215879f, -.2502569f}, // 54438
  {-.036753f, .217196f, -.2515918f}, // 54439
  {-.039716f, .218573f, -.2526780f}, // 54440
  {-.042368f, .219829f, -.2535109f}, // 54441
  {-.044568f, .221124f, -.2540921f}, // 54442
  {-.046272f, .222438f, -.2544507f}, // 54443
  {-.047708f, .223984f, -.2546589f}, // 54444
  {-.049165f, .225523f, -.2548138f}, // 54445
  {-.050320f, .226681f, -.2550384f}, // 54446
  {-.051632f, .227770f, -.2553954f}, // 54447
  {-.053206f, .228809f, -.2559116f}, // 54448
  {-.054691f, .230280f, -.2566430f}, // 54449
  {-.056181f, .231826f, -.2576299f}, // 54450
  {-.057584f, .233411f, -.2588381f}, // 54451
  {-.058957f, .235076f, -.2601591f}, // 54452
  {-.060065f, .236346f, -.2614713f}, // 54453
  {-.061021f, .237712f, -.2627366f}, // 54454
  {-.061936f, .239355f, -.2638367f}, // 54455
  {-.062800f, .241016f, -.2646203f}, // 54456
  {-.063869f, .242720f, -.2651745f}, // 54457
  {-.065327f, .244486f, -.2656467f}, // 54458
  {-.067349f, .246143f, -.2661617f}, // 54459
  {-.069530f, .247660f, -.2668088f}, // 54460
  {-.071332f, .249063f, -.2676291f}, // 54461
  {-.073061f, .251084f, -.2686237f}, // 54462
  {-.074696f, .252765f, -.2697643f}, // 54463
  {-.076492f, .254818f, -.2710246f}, // 54464
  {-.078584f, .256878f, -.2722461f}, // 54465
};

const int s1_mjd_range[2] = { 54344, 54465 };

static const xyz s2[] = {
  {.119926f, .539795f, -.4287334f}, // 54618
  {.122599f, .539282f, -.4296733f}, // 54619
  {.125604f, .538545f, -.4303358f}, // 54620
  {.129022f, .537432f, -.4307708f}, // 54621
  {.132770f, .536157f, -.4310959f}, // 54622
  {.136409f, .535023f, -.4314450f}, // 54623
  {.139862f, .533821f, -.4319064f}, // 54624
  {.143211f, .532810f, -.4325315f}, // 54625
  {.146566f, .531717f, -.4333207f}, // 54626
  {.150059f, .530750f, -.4342625f}, // 54627
  {.153708f, .529230f, -.4352712f}, // 54628
  {.157068f, .527722f, -.4361896f}, // 54629
  {.160557f, .526139f, -.4369375f}, // 54630
  {.163853f, .524745f, -.4374952f}, // 54631
  {.166759f, .523375f, -.4378270f}, // 54632
  {.169548f, .521967f, -.4379951f}, // 54633
  {.172402f, .520748f, -.4380640f}, // 54634
  {.175154f, .519104f, -.4380358f}, // 54635
  {.177759f, .517479f, -.4379648f}, // 54636
  {.180363f, .515939f, -.4379085f}, // 54637
  {.183588f, .514407f, -.4379158f}, // 54638
  {.186973f, .512933f, -.4381027f}, // 54639
  {.190223f, .511392f, -.4385269f}, // 54640
  {.193525f, .510010f, -.4392002f}, // 54641
  {.196463f, .508450f, -.4400651f}, // 54642
  {.199396f, .507144f, -.4410398f}, // 54643
  {.201886f, .505901f, -.4420680f}, // 54644
  {.204186f, .504066f, -.4429893f}, // 54645
  {.206511f, .502126f, -.4437771f}, // 54646
  {.208734f, .499884f, -.4443840f}, // 54647
  {.211255f, .497632f, -.4447553f}, // 54648
  {.213559f, .495370f, -.4449413f}, // 54649
  {.216149f, .493286f, -.4450863f}, // 54650
  {.218818f, .491229f, -.4453621f}, // 54651
  {.221700f, .489137f, -.4458309f}, // 54652
  {.224624f, .487291f, -.4464747f}, // 54653
  {.227207f, .485447f, -.4472565f}, // 54654
  {.229771f, .483384f, -.4480664f}, // 54655
  {.231853f, .481173f, -.4487570f}, // 54656
  {.234144f, .479243f, -.4493163f}, // 54657
  {.236459f, .477280f, -.4497288f}, // 54658
  {.238787f, .475010f, -.4498757f}, // 54659
  {.241179f, .472528f, -.4497844f}, // 54660
  {.243325f, .469909f, -.4495398f}, // 54661
  {.245291f, .467105f, -.4491896f}, // 54662
  {.247842f, .464123f, -.4487776f}, // 54663
  {.250546f, .461605f, -.4484082f}, // 54664
  {.252916f, .459118f, -.4481648f}, // 54665
  {.254954f, .456614f, -.4480718f}, // 54666
  {.257172f, .453836f, -.4482027f}, // 54667
  {.259583f, .450902f, -.4486146f}, // 54668
  {.262270f, .447726f, -.4492319f}, // 54669
  {.265041f, .444176f, -.4499528f}, // 54670
  {.267752f, .440735f, -.4507245f}, // 54671
  {.270205f, .437449f, -.4514756f}, // 54672
  {.272792f, .434829f, -.4521019f}, // 54673
  {.274957f, .432400f, -.4525169f}, // 54674
  {.276706f, .429685f, -.4527193f}, // 54675
  {.278295f, .426967f, -.4527730f}, // 54676
  {.279393f, .424095f, -.4527443f}, // 54677
  {.280189f, .421356f, -.4527960f}, // 54678
  {.281015f, .418309f, -.4530106f}, // 54679
  {.282233f, .415093f, -.4534397f}, // 54680
  {.283650f, .411639f, -.4540604f}, // 54681
  {.285242f, .408117f, -.4548430f}, // 54682
  {.286912f, .404654f, -.4556345f}, // 54683
  {.288545f, .401369f, -.4563016f}, // 54684
  {.289915f, .398428f, -.4568091f}, // 54685
  {.290768f, .395594f, -.4571338f}, // 54686
  {.291378f, .392687f, -.4572796f}, // 54687
  {.291927f, .389503f, -.4572741f}, // 54688
  {.292402f, .386011f, -.4571430f}, // 54689
  {.292772f, .382648f, -.4569244f}, // 54690
  {.292989f, .379366f, -.4567038f}, // 54691
  {.293028f, .376324f, -.4565913f}, // 54692
  {.293033f, .373400f, -.4566224f}, // 54693
  {.293585f, .370602f, -.4568064f}, // 54694
  {.294201f, .367988f, -.4571466f}, // 54695
  {.294489f, .365067f, -.4577060f}, // 54696
  {.294813f, .361841f, -.4584595f}, // 54697
  {.295375f, .358674f, -.4592921f}, // 54698
  {.296075f, .355608f, -.4600717f}, // 54699
  {0.296453f, 0.352475f, -.4606745f}, // 54700
  {0.296801f, 0.349322f, -.4610545f}, // 54701
  {0.296945f, 0.346068f, -.4612418f}, // 54702
  {0.296939f, 0.342717f, -.4613117f}, // 54703
  {0.296831f, 0.339286f, -.4613523f}, // 54704
  {0.296649f, 0.335798f, -.4614655f}, // 54705
  {0.296402f, 0.332275f, -.4617495f}, // 54706
  {0.296090f, 0.328735f, -.4622745f}, // 54707
  {0.295714f, 0.325186f, -0.4630471f}, // 54708
  {0.295272f, 0.321636f, -0.4640229f}, // 54709
  {0.294765f, 0.318086f, -0.4650688f}, // 54710
  {0.294194f, 0.314538f, -0.4660528f}, // 54711
  {0.293560f, 0.310994f, -0.4669029f}, // 54712
  {0.292864f, 0.307456f, -0.4675628f}, // 54713
  {0.292107f, 0.303926f, -0.4680198f}, // 54714
  {0.291290f, 0.300404f, -0.4683243f}, // 54715
  {0.290413f, 0.296892f, -0.4685212f}, // 54716
  {0.289478f, 0.293393f, -0.4686735f}, // 54717
  {0.288484f, 0.289906f, -0.4688471f}, // 54718
  {0.287431f, 0.286432f, -0.4691097f}, // 54719
  {0.286320f, 0.282974f, -0.4695332f}, // 54720
  {0.285151f, 0.279531f, -0.4701730f}, // 54721
  {0.283925f, 0.276105f, -0.4710708f}, // 54722
  {0.282641f, 0.272696f, -0.4722353f}, // 54723
  {0.281301f, 0.269306f, -0.4736246f}, // 54724
  {0.279905f, 0.265935f, -0.4751437f}, // 54725
  {0.278452f, 0.262584f, -0.4766613f}, // 54726
  {0.276944f, 0.259254f, -0.4780526f}, // 54727
  {0.275380f, 0.255946f, -0.4792253f}, // 54728
  {0.273761f, 0.252661f, -0.4801554f}, // 54729
  {0.272088f, 0.249400f, -0.4808904f}, // 54730
  {0.270361f, 0.246162f, -0.4815341f}, // 54731
  {0.268579f, 0.242951f, -0.4822169f}, // 54732
  {0.266745f, 0.239765f, -0.4830548f}, // 54733
  {0.264858f, 0.236606f, -0.4841229f}, // 54734
  {0.262918f, 0.233475f, -0.4854393f}, // 54735
  {0.260927f, 0.230372f, -0.4869649f}, // 54736
  {0.258884f, 0.227298f, -0.4886160f}, // 54737
  {0.256790f, 0.224255f, -0.4902879f}, // 54738
  {0.254646f, 0.221243f, -0.4918743f}, // 54739
  {0.252452f, 0.218262f, -0.4933005f}, // 54740
  {0.250208f, 0.215313f, -0.4945303f}, // 54741
  {0.247916f, 0.212398f, -0.4955634f}, // 54742
  {0.245576f, 0.209517f, -0.4964362f}, // 54743
  {0.243188f, 0.206670f, -0.4972076f}, // 54744
  {0.240754f, 0.203858f, -0.4979441f}, // 54745
  {0.238272f, 0.201083f, -0.4987193f}, // 54746
  {0.235745f, 0.198345f, -0.4996058f}, // 54747
  {0.233173f, 0.195644f, -0.5006623f}, // 54748
  {0.230557f, 0.192981f, -0.5019310f}, // 54749
  {0.227897f, 0.190357f, -0.5034337f}, // 54750
  {0.225193f, 0.187773f, -0.5051530f}, // 54751
  {0.222447f, 0.185229f, -0.5070241f}, // 54752
  {0.219659f, 0.182725f, -0.5089366f}, // 54753
  {0.216830f, 0.180264f, -0.5107601f}, // 54754
  {0.213961f, 0.177844f, -0.5123825f}, // 54755
  {0.211052f, 0.175467f, -0.5137450f}, // 54756
  {0.208104f, 0.173134f, -0.5148686f}, // 54757
  {0.205118f, 0.170845f, -0.5158506f}, // 54758
  {0.202094f, 0.168600f, -0.5168249f}, // 54759
  {0.199034f, 0.166400f, -0.5179178f}, // 54760
  {0.195938f, 0.164246f, -0.5192123f}, // 54761
  {0.192807f, 0.162139f, -0.5207290f}, // 54762
  {0.189641f, 0.160078f, -0.5224289f}, // 54763
  {0.186442f, 0.158065f, -0.5242362f}, // 54764
  {0.183210f, 0.156099f, -0.5260581f}, // 54765
  {0.179946f, 0.154182f, -0.5278037f}, // 54766
  {0.176650f, 0.152314f, -0.5293959f}, // 54767
  {0.173325f, 0.150495f, -0.5307899f}, // 54768
  {0.169970f, 0.148726f, -0.5319748f}, // 54769
  {0.166587f, 0.147008f, -0.5329723f}, // 54770
  {0.163176f, 0.145340f, -0.5338323f}, // 54771
  {0.159738f, 0.143723f, -0.5346197f}, // 54772
  {0.156274f, 0.142158f, -0.5354052f}, // 54773
  {0.152784f, 0.140645f, -0.5362565f}, // 54774
  {0.149271f, 0.139185f, -0.5372321f}, // 54775
  {0.145734f, 0.137777f, -0.5383752f}, // 54776
  {0.142175f, 0.136422f, -0.5397090f}, // 54777
  {0.138594f, 0.135121f, -0.5412344f}, // 54778
  {0.134992f, 0.133874f, -0.5429174f}, // 54779
  {0.131371f, 0.132681f, -0.5446834f}, // 54780
  {0.127731f, 0.131543f, -0.5464202f}, // 54781
  {0.124073f, 0.130459f, -0.5480074f}, // 54782
  {0.120397f, 0.129430f, -0.5493565f}, // 54783
  {0.116706f, 0.128457f, -0.5504457f}, // 54784
  {0.113000f, 0.127539f, -0.5513367f}, // 54785
  {0.109279f, 0.126678f, -0.5521535f}, // 54786
  {0.105545f, 0.125872f, -0.5530342f}, // 54787
  {0.101799f, 0.125123f, -0.5540809f}, // 54788
  {0.098041f, 0.124430f, -0.5553304f}, // 54789
  {0.094273f, 0.123794f, -0.5567506f}, // 54790
  {0.090496f, 0.123214f, -0.5582629f}, // 54791
  {0.086710f, 0.122692f, -0.5597717f}, // 54792
  {0.082917f, 0.122227f, -0.5611889f}, // 54793
  {0.079117f, 0.121819f, -0.5624478f}, // 54794
  {0.075311f, 0.121469f, -0.5635084f}, // 54795
  {0.071500f, 0.121176f, -0.5643584f}, // 54796
  {0.067686f, 0.120941f, -0.5650124f}, // 54797
  {0.063870f, 0.120763f, -0.5655111f}, // 54798
  {0.060051f, 0.120643f, -0.5659155f}, // 54799
  {0.056232f, 0.120581f, -0.5662984f}, // 54800
  {0.052411f, 0.120576f, -0.5667313f}, // 54801
  {0.048591f, 0.120629f, -0.5672751f}, // 54802
  {0.044773f, 0.120739f, -0.5679754f}, // 54803
  {0.040958f, 0.120908f, -0.5688561f}, // 54804
  {0.037147f, 0.121134f, -0.5699194f}, // 54805
  {0.033341f, 0.121418f, -0.5711430f}, // 54806
  {0.029541f, 0.121759f, -0.5724719f}, // 54807
  {0.025748f, 0.122158f, -0.5739260f}, // 54808
  {0.021963f, 0.122615f, -0.5752938f}, // 54809
  {0.018187f, 0.123129f, -0.5764801f}, // 54810
  {0.014421f, 0.123700f, -0.5774336f}, // 54811
  {0.010665f, 0.124328f, -0.5781753f}, // 54812
  {0.006921f, 0.125013f, -0.5788010f}, // 54813
  {0.003190f, 0.125755f, -0.5794499f}, // 54814
  {-0.000528f, 0.126554f, -0.5802526f}, // 54815
  {-0.004231f, 0.127409f, -0.5812807f}, // 54816
  {-0.007919f, 0.128320f, -0.5825247f}, // 54817
  {-0.011590f, 0.129287f, -0.5839062f}, // 54818
  {-0.015244f, 0.130310f, -0.5853138f}, // 54819
  {-0.018880f, 0.131389f, -0.5866413f}, // 54820
  {-0.022496f, 0.132522f, -0.5878120f}, // 54821
  {-0.026092f, 0.133711f, -0.5887843f}, // 54822
  {-0.029668f, 0.134954f, -0.5895486f}, // 54823
  {-0.033221f, 0.136252f, -0.5901207f}, // 54824
  {-0.036752f, 0.137604f, -0.5905379f}, // 54825
  {-0.040259f, 0.139009f, -0.5908556f}, // 54826
  {-0.043741f, 0.140468f, -0.5911419f}, // 54827
  {-0.047198f, 0.141980f, -0.5914685f}, // 54828
  {-0.050629f, 0.143544f, -0.5918997f}, // 54829
  {-0.054032f, 0.145161f, -0.5924836f}, // 54830
  {-0.057407f, 0.146830f, -0.5932450f}, // 54831
};

const int s2_mjd_range[2] = { 54618, 54831 };

static const xyz s3[] = {
  {-0.082685f, 0.460874f, 0.3021813f}, // 54941
  {-0.080721f, 0.463611f, 0.3005903f}, // 54942
  {-0.078694f, 0.466454f, 0.2988294f}, // 54943
  {-0.076963f, 0.469232f, 0.2970038f}, // 54944
  {-0.075991f, 0.471682f, 0.2952478f}, // 54945
  {-0.075008f, 0.473877f, 0.2936487f}, // 54946
  {-0.073761f, 0.476149f, 0.2922367f}, // 54947
  {-0.072015f, 0.478110f, 0.2910283f}, // 54948
  {-0.069792f, 0.480265f, 0.2899669f}, // 54949
  {-0.067650f, 0.482280f, 0.2889631f}, // 54950
  {-0.065373f, 0.484488f, 0.2878955f}, // 54951
  {-0.062358f, 0.486504f, 0.2866972f}, // 54952
  {-0.059598f, 0.488673f, 0.2853034f}, // 54953
  {-0.056755f, 0.490530f, 0.2836949f}, // 54954
  {-0.053955f, 0.492452f, 0.2819299f}, // 54955
  {-0.051587f, 0.494289f, 0.2801281f}, // 54956
  {-0.048945f, 0.495937f, 0.2784258f}, // 54957
  {-0.045835f, 0.497736f, 0.2768940f}, // 54958
  {-0.042770f, 0.499842f, 0.2756343f}, // 54959
  {-0.039714f, 0.502170f, 0.2746709f}, // 54960
  {-0.036650f, 0.504390f, 0.2739250f}, // 54961
  {-0.033693f, 0.506145f, 0.2733122f}, // 54962
  {-0.031220f, 0.507994f, 0.2727738f}, // 54963
  {-0.028517f, 0.509873f, 0.2722296f}, // 54964
  {-0.025851f, 0.511942f, 0.2716469f}, // 54965
  {-0.023145f, 0.513781f, 0.2709357f}, // 54966
  {-0.020158f, 0.515489f, 0.2700844f}, // 54967
  {-0.016675f, 0.516943f, 0.2691105f}, // 54968
  {-0.012994f, 0.518561f, 0.2679884f}, // 54969
  {-0.009516f, 0.520277f, 0.2666929f}, // 54970
  {-0.005978f, 0.521657f, 0.2652481f}, // 54971
  {-0.002656f, 0.522763f, 0.2637621f}, // 54972
  {0.000572f, 0.524115f, 0.2623659f}, // 54973
  {0.003613f, 0.525296f, 0.2611693f}, // 54974
  {0.007033f, 0.526312f, 0.2601518f}, // 54975
  {0.010714f, 0.527521f, 0.2592804f}, // 54976
  {0.013785f, 0.528797f, 0.2585247f}, // 54977
  {0.016534f, 0.530304f, 0.2577921f}, // 54978
  {0.019267f, 0.531547f, 0.2569280f}, // 54979
  {0.021787f, 0.532690f, 0.2558757f}, // 54980
  {0.024508f, 0.533410f, 0.2546087f}, // 54981
  {0.027797f, 0.533708f, 0.2531730f}, // 54982
  {0.031492f, 0.533616f, 0.2517066f}, // 54983
  {0.035452f, 0.533777f, 0.2503497f}, // 54984
  {0.039462f, 0.534445f, 0.2491560f}, // 54985
  {0.043727f, 0.535272f, 0.2481736f}, // 54986
  {0.048111f, 0.536622f, 0.2474155f}, // 54987
  {0.051714f, 0.537838f, 0.2468980f}, // 54988
  {0.055213f, 0.538842f, 0.2465168f}, // 54989
  {0.058587f, 0.539524f, 0.2462355f}, // 54990
  {0.061632f, 0.540162f, 0.2459755f}, // 54991
  {0.064327f, 0.540480f, 0.2456542f}, // 54992
  {0.067552f, 0.540503f, 0.2452408f}, // 54993
  {0.071010f, 0.540605f, 0.2446522f}, // 54994
  {0.074693f, 0.541115f, 0.2439193f}, // 54995
  {0.078490f, 0.541590f, 0.2430825f}, // 54996
  {0.082161f, 0.541857f, 0.2421601f}, // 54997
  {0.085603f, 0.541979f, 0.2411582f}, // 54998
  {0.088514f, 0.541731f, 0.2401089f}, // 54999
  {0.091192f, 0.541227f, 0.2391466f}, // 55000
  {0.094047f, 0.540788f, 0.2383445f}, // 55001
  {0.097184f, 0.540525f, 0.2377387f}, // 55002
  {0.100266f, 0.540368f, 0.2373607f}, // 55003
  {0.103077f, 0.539852f, 0.2371340f}, // 55004
  {0.105962f, 0.539205f, 0.2369968f}, // 55005
  {0.109160f, 0.538481f, 0.2368046f}, // 55006
  {0.112407f, 0.537985f, 0.2365211f}, // 55007
  {0.115316f, 0.537703f, 0.2360314f}, // 55008
  {0.118022f, 0.537260f, 0.2353690f}, // 55009
  {0.120792f, 0.536743f, 0.2346377f}, // 55010
  {0.123672f, 0.535889f, 0.2339361f}, // 55011
  {0.126780f, 0.534994f, 0.2333908f}, // 55012
  {0.130404f, 0.533661f, 0.2330773f}, // 55013
  {0.134278f, 0.532614f, 0.2330154f}, // 55014
  {0.138442f, 0.531693f, 0.2331583f}, // 55015
  {0.142451f, 0.531084f, 0.2334300f}, // 55016
  {0.145983f, 0.530420f, 0.2338020f}, // 55017
  {0.149106f, 0.529622f, 0.2342226f}, // 55018
  {0.152171f, 0.528787f, 0.2346173f}, // 55019
  {0.154779f, 0.527693f, 0.2349537f}, // 55020
  {0.157248f, 0.526804f, 0.2351494f}, // 55021
  {0.159804f, 0.525885f, 0.2351932f}, // 55022
  {0.162759f, 0.524949f, 0.2351182f}, // 55023
  {0.165834f, 0.524225f, 0.2348958f}, // 55024
  {0.168990f, 0.523430f, 0.2345886f}, // 55025
  {0.171812f, 0.522348f, 0.2342939f}, // 55026
  {0.175551f, 0.521280f, 0.2339948f}, // 55027
  {0.179203f, 0.520105f, 0.2337871f}, // 55028
  {0.182555f, 0.519087f, 0.2337338f}, // 55029
  {0.185902f, 0.518304f, 0.2338061f}, // 55030
  {0.188822f, 0.517354f, 0.2339583f}, // 55031
  {0.191865f, 0.516032f, 0.2341028f}, // 55032
  {0.194948f, 0.514852f, 0.2341688f}, // 55033
  {0.197849f, 0.513730f, 0.2340932f}, // 55034
  {0.200641f, 0.512232f, 0.2338083f}, // 55035
  {0.203110f, 0.510666f, 0.2332832f}, // 55036
  {0.205383f, 0.508840f, 0.2325737f}, // 55037
  {0.207823f, 0.506910f, 0.2318141f}, // 55038
  {0.210544f, 0.504845f, 0.2311129f}, // 55039
  {0.213228f, 0.502860f, 0.2305519f}, // 55040
  {0.215562f, 0.500290f, 0.2302455f}, // 55041
  {0.217482f, 0.497963f, 0.2301737f}, // 55042
  {0.219564f, 0.495687f, 0.2303039f}, // 55043
  {0.221717f, 0.492992f, 0.2305858f}, // 55044
  {0.223923f, 0.490387f, 0.2309462f}, // 55045
  {0.225884f, 0.487663f, 0.2312341f}, // 55046
  {0.228043f, 0.485180f, 0.2313905f}, // 55047
  {0.229945f, 0.482412f, 0.2314684f}, // 55048
  {0.232011f, 0.480009f, 0.2313760f}, // 55049
  {0.234209f, 0.477582f, 0.2310516f}, // 55050
  {0.236290f, 0.475393f, 0.2306006f}, // 55051
  {0.238347f, 0.473197f, 0.2300245f}, // 55052
  {0.240378f, 0.470779f, 0.2293592f}, // 55053
  {0.242359f, 0.468407f, 0.2287013f}, // 55054
  {0.244468f, 0.465724f, 0.2281520f}, // 55055
  {0.246616f, 0.463408f, 0.2277761f}, // 55056
  {0.248510f, 0.461289f, 0.2275935f}, // 55057
  {0.249911f, 0.459221f, 0.2275984f}, // 55058
  {0.251454f, 0.456882f, 0.2276754f}, // 55059
  {0.252817f, 0.454455f, 0.2277336f}, // 55060
  {0.253972f, 0.452087f, 0.2276357f}, // 55061
  {0.254959f, 0.449643f, 0.2272350f}, // 55062
  {0.256183f, 0.447185f, 0.2265682f}, // 55063
  {0.258076f, 0.444750f, 0.2256752f}, // 55064
  {0.259644f, 0.442583f, 0.2246597f}, // 55065
  {0.260861f, 0.440378f, 0.2237234f}, // 55066
  {0.261849f, 0.438102f, 0.2229179f}, // 55067
  {0.263173f, 0.435873f, 0.2223011f}, // 55068
  {0.264169f, 0.433594f, 0.2219331f}, // 55069
  {0.265334f, 0.431220f, 0.2217375f}, // 55070
  {0.266397f, 0.428792f, 0.2216360f}, // 55071
  {0.267560f, 0.426232f, 0.2215667f}, // 55072
  {0.268813f, 0.423596f, 0.2215057f}, // 55073
  {0.269845f, 0.420831f, 0.2213906f}, // 55074
  {0.270326f, 0.418182f, 0.2211658f}, // 55075
  {0.270888f, 0.414879f, 0.2207834f}, // 55076
  {0.271377f, 0.411789f, 0.2202281f}, // 55077
  {0.272189f, 0.408904f, 0.2194951f}, // 55078
  {0.272662f, 0.406293f, 0.2186258f}, // 55079
  {0.272755f, 0.403612f, 0.2176728f}, // 55080
  {0.272474f, 0.400645f, 0.2167313f}, // 55081
  {0.272284f, 0.397528f, 0.2158648f}, // 55082
  {0.272147f, 0.394576f, 0.2151620f}, // 55083
  {0.271788f, 0.391815f, 0.2146451f}, // 55084
  {0.271632f, 0.389004f, 0.2142866f}, // 55085
  {0.271529f, 0.385940f, 0.2140310f}, // 55086
  {0.271934f, 0.382831f, 0.2137400f}, // 55087
  {0.272445f, 0.379756f, 0.2133130f}, // 55088
  {0.273209f, 0.376655f, 0.2126821f}, // 55089
  {0.274149f, 0.373699f, 0.2118084f}, // 55090
  {0.275125f, 0.371062f, 0.2106628f}, // 55091
  {0.275634f, 0.368419f, 0.2093246f}, // 55092
  {0.275485f, 0.365847f, 0.2079786f}, // 55093
  {0.274886f, 0.363302f, 0.2067065f}, // 55094
  {0.274048f, 0.360574f, 0.2056231f}, // 55095
  {0.273493f, 0.357660f, 0.2048202f}, // 55096
  {0.272695f, 0.354578f, 0.2042898f}, // 55097
  {0.272008f, 0.351326f, 0.2039107f}, // 55098
  {0.271125f, 0.348147f, 0.2036070f}, // 55099
  {0.270221f, 0.345041f, 0.2033486f}, // 55100
  {0.269111f, 0.342007f, 0.2030675f}, // 55101
  {0.268301f, 0.339051f, 0.2026985f}, // 55102
  {0.267298f, 0.336754f, 0.2021041f}, // 55103
  {0.266568f, 0.334137f, 0.2012353f}, // 55104
  {0.265598f, 0.331384f, 0.2001280f}, // 55105
  {0.265034f, 0.328390f, 0.1988859f}, // 55106
  {0.264601f, 0.325703f, 0.1976007f}, // 55107
  {0.264180f, 0.323025f, 0.1962699f}, // 55108
  {0.263647f, 0.320403f, 0.1949947f}, // 55109
  {0.263210f, 0.317966f, 0.1938960f}, // 55110
  {0.262359f, 0.315597f, 0.1929659f}, // 55111
  {0.261950f, 0.313388f, 0.1922000f}, // 55112
  {0.261960f, 0.311010f, 0.1915802f}, // 55113
  {0.261727f, 0.308543f, 0.1910017f}, // 55114
  {0.261075f, 0.306037f, 0.1903840f}, // 55115
  {0.260090f, 0.303673f, 0.1896730f}, // 55116
  {0.258791f, 0.301426f, 0.1887303f}, // 55117
  {0.257080f, 0.299176f, 0.1875507f}, // 55118
  {0.254937f, 0.296214f, 0.1861591f}, // 55119
  {0.253588f, 0.293115f, 0.1846728f}, // 55120
  {0.252688f, 0.290537f, 0.1832042f}, // 55121
  {0.251857f, 0.288008f, 0.1818797f}, // 55122
  {0.250908f, 0.285597f, 0.1807780f}, // 55123
  {0.249967f, 0.283459f, 0.1798982f}, // 55124
  {0.249009f, 0.281538f, 0.1791857f}, // 55125
  {0.247989f, 0.279289f, 0.1785861f}, // 55126
  {0.247263f, 0.276681f, 0.1780194f}, // 55127
  {0.246042f, 0.273943f, 0.1774932f}, // 55128
  {0.244770f, 0.271084f, 0.1769202f}, // 55129
  {0.243895f, 0.268713f, 0.1762055f}, // 55130
  {0.242984f, 0.266539f, 0.1753278f}, // 55131
  {0.241831f, 0.264274f, 0.1742671f}, // 55132
  {0.240680f, 0.262084f, 0.1730894f}, // 55133
  {0.239377f, 0.259702f, 0.1718486f}, // 55134
  {0.237634f, 0.257537f, 0.1705770f}, // 55135
  {0.235732f, 0.255514f, 0.1693220f}, // 55136
  {0.234599f, 0.253362f, 0.1681839f}, // 55137
  {0.234347f, 0.251584f, 0.1672134f}, // 55138
  {0.233998f, 0.250000f, 0.1663976f}, // 55139
  {0.233313f, 0.248287f, 0.1656459f}, // 55140
  {0.232168f, 0.246532f, 0.1649000f}, // 55141
  {0.230808f, 0.244608f, 0.1641483f}, // 55142
  {0.229148f, 0.242627f, 0.1633050f}, // 55143
  {0.227296f, 0.240539f, 0.1622987f}, // 55144
  {0.225433f, 0.238377f, 0.1611050f}, // 55145
  {0.223616f, 0.236225f, 0.1597590f}, // 55146
  {0.221820f, 0.234117f, 0.1583403f}, // 55147
  {0.220004f, 0.232052f, 0.1569499f}, // 55148
  {0.218142f, 0.230023f, 0.1557013f}, // 55149
  {0.216210f, 0.228029f, 0.1546518f}, // 55150
  {0.214193f, 0.226058f, 0.1538032f}, // 55151
  {0.212097f, 0.224093f, 0.1531148f}, // 55152
  {0.209945f, 0.222128f, 0.1525697f}, // 55153
  {0.207757f, 0.220171f, 0.1521307f}, // 55154
  {0.205544f, 0.218232f, 0.1517118f}, // 55155
  {0.203308f, 0.216318f, 0.1512402f}, // 55156
  {0.201050f, 0.214437f, 0.1506554f}, // 55157
  {0.198764f, 0.212592f, 0.1499334f}, // 55158
  {0.196447f, 0.210785f, 0.1490604f}, // 55159
  {0.194094f, 0.209013f, 0.1480449f}, // 55160
  {0.191708f, 0.207273f, 0.1469283f}, // 55161
  {0.189292f, 0.205564f, 0.1457622f}, // 55162
  {0.186847f, 0.203886f, 0.1446111f}, // 55163
  {0.184379f, 0.202240f, 0.1435438f}, // 55164
  {0.181888f, 0.200630f, 0.1426155f}, // 55165
  {0.179375f, 0.199056f, 0.1418492f}, // 55166
  {0.176841f, 0.197520f, 0.1412317f}, // 55167
  {0.174285f, 0.196023f, 0.1406989f}, // 55168
  {0.171707f, 0.194565f, 0.1401433f}, // 55169
  {0.169109f, 0.193146f, 0.1394494f}, // 55170
  {0.166489f, 0.191766f, 0.1385397f}, // 55171
  {0.163851f, 0.190425f, 0.1374048f}, // 55172
  {0.161194f, 0.189123f, 0.1360897f}, // 55173
  {0.158520f, 0.187861f, 0.1346916f}, // 55174
  {0.155830f, 0.186639f, 0.1333251f}, // 55175
  {0.153124f, 0.185458f, 0.1320907f}, // 55176
  {0.150402f, 0.184319f, 0.1310558f}, // 55177
  {0.147667f, 0.183221f, 0.1302455f}, // 55178
  {0.144917f, 0.182165f, 0.1296424f}, // 55179
  {0.142155f, 0.181151f, 0.1292016f}, // 55180
  {0.139380f, 0.180179f, 0.1288559f}, // 55181
  {0.136593f, 0.179249f, 0.1285294f}, // 55182
  {0.133796f, 0.178362f, 0.1281530f}, // 55183
  {0.130989f, 0.177518f, 0.1276732f}, // 55184
  {0.128172f, 0.176716f, 0.1270555f}, // 55185
  {0.125347f, 0.175957f, 0.1262865f}, // 55186
  {0.122514f, 0.175242f, 0.1253753f}, // 55187
  {0.119674f, 0.174570f, 0.1243536f}, // 55188
  {0.116827f, 0.173941f, 0.1232668f}, // 55189
  {0.113975f, 0.173356f, 0.1221701f}, // 55190
  {0.111118f, 0.172815f, 0.1211203f}, // 55191
  {0.108256f, 0.172317f, 0.1201716f}, // 55192
  {0.105392f, 0.171863f, 0.1193642f}, // 55193
  {0.102524f, 0.171453f, 0.1187040f}, // 55194
  {0.099655f, 0.171087f, 0.1181477f}, // 55195
  {0.096784f, 0.170765f, 0.1176037f}, // 55196
  {0.093913f, 0.170486f, 0.1169544f}, // 55197
  {0.091043f, 0.170252f, 0.1160928f}, // 55198
  {0.088173f, 0.170061f, 0.1149668f}, // 55199
  {0.085305f, 0.169914f, 0.1136029f}, // 55200
  {0.082440f, 0.169812f, 0.1121002f}, // 55201
  {0.079577f, 0.169753f, 0.1105923f}, // 55202
  {0.076719f, 0.169737f, 0.1092065f}, // 55203
  {0.073866f, 0.169766f, 0.1080315f}, // 55204
  {0.071017f, 0.169838f, 0.1070997f}, // 55205
  {0.068175f, 0.169954f, 0.1063912f}, // 55206
  {0.065340f, 0.170113f, 0.1058544f}, // 55207
  {0.062512f, 0.170316f, 0.1054265f}, // 55208
  {0.059693f, 0.170562f, 0.1050374f}, // 55209
  {0.056882f, 0.170851f, 0.1046190f}, // 55210
  {0.054081f, 0.171183f, 0.1041121f}, // 55211
  {0.051291f, 0.171558f, 0.1034753f}, // 55212
  {0.048511f, 0.171975f, 0.1026898f}, // 55213
  {0.045744f, 0.172435f, 0.1017609f}, // 55214
  {0.042989f, 0.172937f, 0.1007162f}, // 55215
  {0.040247f, 0.173482f, 0.0995995f}, // 55216
  {0.037518f, 0.174068f, 0.0984621f}, // 55217
  {0.034805f, 0.174696f, 0.0973588f}, // 55218
  {0.032106f, 0.175366f, 0.0963398f}, // 55219
  {0.029424f, 0.176077f, 0.0954400f}, // 55220
  {0.026758f, 0.176828f, 0.0946708f}, // 55221
  {0.024109f, 0.177621f, 0.0940086f}, // 55222
  {0.021477f, 0.178454f, 0.0933845f}, // 55223
  {0.018865f, 0.179327f, 0.0926905f}, // 55224
  {0.016271f, 0.180240f, 0.0918060f}, // 55225
  {0.013697f, 0.181193f, 0.0906419f}, // 55226
  {0.011144f, 0.182185f, 0.0891821f}, // 55227
  {0.008611f, 0.183216f, 0.0874969f}, // 55228
};

const int s3_mjd_range[2] = { 54941, 55228 };


void
get_iers_bulletin_a_for_season( const xyz s[], int mjd_min, double mjd,
    double *dut1, double *x, double *y )
{
    double mjd_floor;
    double r = modf( mjd, &mjd_floor );
    int k = (int) mjd_floor - mjd_min;
    *dut1 = (1-r)*s[k].dut1 + r*s[k+1].dut1;
    *x = (1-r)*s[k].x + r*s[k+1].x;
    *y = (1-r)*s[k].y + r*s[k+1].y;
}

int
get_iers_bulletin_a( double mjd, double *dut1, double *x, double *y )
{
    if ( (s1_mjd_range[0] <= mjd) && (mjd <= s1_mjd_range[1]) )
    {
        get_iers_bulletin_a_for_season( s1, s1_mjd_range[0], mjd, dut1, x, y );
    }
    else if ( (s2_mjd_range[0] <= mjd) && (mjd <= s2_mjd_range[1]) )
    {
        get_iers_bulletin_a_for_season( s2, s2_mjd_range[0], mjd, dut1, x, y );
    }
    else if ( (s3_mjd_range[0] <= mjd) && (mjd <= s3_mjd_range[1]) )
    {
        get_iers_bulletin_a_for_season( s3, s3_mjd_range[0], mjd, dut1, x, y );
    }
    else
    {
        assert( 1 == 0 );
        return -1;
    }

    return 0;
}
